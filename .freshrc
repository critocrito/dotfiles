export BIN_DIR=~/.local/bin
export CONFIG_DIR=~/.config
export CACHE_DIR=~/.cache
export DATA_DIR=~/.local/share

mkdir -p $BIN_DIR
mkdir -p $CONFIG_DIR
mkdir -p $CACHE_DIR

fresh freshshell/fresh bin/fresh --bin

# Set up the basic shell. This should be first.
for F in aliases profile env functions; do fresh shell/$F --file; done

fresh pam_environment --file
for MOD in ssh dbus; do fresh $MOD/pam_environment --file; done

fresh git/gitconfig --file
fresh git/git-prompt.rc --file
for F in aliases env functions; do fresh git/$F --file; done

for F in env rc; do fresh gnupg/$F --file; done
for F in dirmngr.conf gpg.conf gpg-agent.conf sks-keyservers.netCA.pem; do
  fresh gnupg/$F --file=$CONFIG_DIR/gnupg/$F
done

for F in aliases env; do fresh grep/$F --file; done

for F in aliases functions; do fresh emacs/$F --file; done

for F in functions zprofile zshenv zshrc; do fresh zsh/$F --file; done

fresh systemd/aliases --file
mkdir -p $CONFIG_DIR/systemd/user

# xorg
mkdir -p $CONFIG_DIR/xorg
for F in xserverrc xinitrc; do fresh xorg/$F --file; done
for F in resources modmap; do fresh xorg/$F --file=$CONFIG_DIR/xorg/$F; done

# xmonad
for DIR in $CACHE_DIR $DATA_DIR; do mkdir -p $DIR/xmonad; done
fresh xmonad --file=$CONFIG_DIR/xmonad/
fresh bin/get-volume --bin=$BIN_DIR/get-volume

for F in rc profile functions; do fresh haskell/$F --file; done

# Install or upgrade nvm
NVM_DIR="$HOME/.nvm"
if [ -d $NVM_DIR ]
then
  echo "Upgrading nvm."
  cd "$NVM_DIR"
  git fetch origin
  git checkout `git describe --abbrev=0 --tags --match "v[0-9]*" origin`
else
  echo "Installing nvm."
  git clone https://github.com/creationix/nvm.git "$NVM_DIR"
  cd "$NVM_DIR"
  git checkout `git describe --abbrev=0 --tags --match "v[0-9]*" origin`
fi
cd
for F in rc env functions; do fresh node/$F --file; done


# Install or upgrade pyenv
PYENV_ROOT="$HOME/.pyenv"
if [ -s $PYENV_ROOT ]
then
  echo "Upgrading pyenv."
  cd $PYENV_ROOT
  git pull
  echo "Upgrading pyenv-virtualenv."
  cd $PYENV_ROOT/plugins/pyenv-virtualenv
  git pull
else
  echo "Installing pyenv."
  git clone https://github.com/pyenv/pyenv.git $PYENV_ROOT
  echo "Installing pyenv-virtualenv."
  git clone https://github.com/pyenv/pyenv-virtualenv.git $PYENV_ROOT/plugins/pyenv-virtualenv
fi
cd
for F in rc profile env functions; do fresh python/$F --file; done
